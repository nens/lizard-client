<div>
  <div class="active card db-card">
    <timeseries asset="asset" time-state="timeState"></timeseries>
    <cardheader
      asset="asset"
      ng-if="!isNested">
    </cardheader>

    <div ng-if="isNested">
      <header class="card-header nested-card-header">
        <div ng-if="asset" class="card-header-center">
          <span class="icons-nested fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x iconcircle"></i>
            <i class="asset-icon"
               ng-class="getIconClass(asset.entity_name, asset)">
            </i>
          </span>
          <div class="nested-card-header-txt">
            <div class="nested-asset-title">
              {{ asset.code | objectTitle | translate }}
            </div>
            <div class="nested-asset-ts-count" translate>
              {{asset.timeseries.length}} {{ 'TIMESERIES' | translate }}
            </div>
          </div>
        </div>
      </header>
    </div>

    <div class="db-ts-collection-empty"
        ng-if="!assetHasChildren(asset) && noData && (assetType==='geometry' || asset.entity_name !== 'leveecrosssection')">
      <div class="no-ts-message">
        <i translate>No timeseries data available for this asset.</i>
      </div>
    </div>

    <div
      ng-if="asset.timeseries.length > 0"
      id="drag-container"
      class="db-ts-collection">
      <div
        ng-repeat="timeseries in asset.timeseries track by $index"
        ng-init="key = getKeyForAssetTimeseries(timeseries.uuid); chart = getOrCreateChart(key)"
        ng-show="(extended || isChartActive(key) || $index < 3)"
        id="{{ key }}"
        data-uuid="{{ key }}"
        class="draggable-ts db-card-single-ts"
        ng-class="{
          'color-picker-is-open': colorPickersSettings[key],
          'active': isChartActive(key)
        }">

        <!-- asset/nested-asset TS card: START -->
        <div
          id="{{ 'clickable-' + key }}"
          ng-click="toggleChart(key);">

          <div
            class="db-card-color-picker-btn"
            ng-style="{'background-color': chart.color}"
            ng-click="toggleColorPicker(key); $event.stopPropagation();">
          </div>

          <div
            class="db-card-single-ts-name"
            title="XXX {{ metaData.location }}, {{ metaData.uuid }}, {{ metaData.parameter }}"
            ng-init="displayName = getTsDisplayName(selection)">
            Hmm {{ displayName | truncate: 42 }}
          </div>

          <color-picker
              ng-show="colorPickersSettings[key]"
              chart-key="{{ key }}">
          </color-picker>
        </div>
        <!-- asset/nested-asset TS card: END -->

      </div>
    </div>
  </div>

  <db-nested-asset asset="asset" time-state="timeState"></db-nested-asset>

</div>
