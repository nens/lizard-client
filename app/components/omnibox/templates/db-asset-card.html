<div>
  <div class="active card db-card">
    <timeseries asset="asset" time-state="timeState"></timeseries>
    <cardheader
      asset="asset"
      ng-if="!isNested">
    </cardheader>

    <div ng-if="isNested">

      <header class="card-header nested-card-header">
        <div ng-if="asset" class="card-header-center">
          <span class="icons-nested fa-stack fa-lg">
            <i class="fa fa-circle fa-stack-2x iconcircle"></i>
            <i class="asset-icon"
               ng-class="getIconClass(asset.entity_name, asset)">
            </i>
          </span>


          <div class="nested-card-header-txt">
            <div class="nested-asset-title">
              {{ asset.code | objectTitle | translate }}
            </div>
            <div class="nested-asset-ts-count" translate>
              {{asset.timeseries.length}} TIMESERIES
            </div>
          </div>


        </div>
      </header>

    </div>

    <div class="db-ts-collection-empty"
        ng-if="!assetHasChildren(asset) && noData && (assetType==='geometry' || asset.entity_name !== 'leveecrosssection')">
      <div class="no-ts-message">
        <i translate>No timeseries data available for this asset.</i>
      </div>
    </div>

    <div
      ng-if="asset.timeseries.length > 0"
      id="drag-container"
      class="db-ts-collection">
      <div
        ng-repeat="selection in state.selections"
        ng-init="metaData = getSelectionMetaData(selection)"
        ng-if="getSelectionMetaData(selection).match"
        ng-show="extended || selection.active || isOneOfFirstThree(selection.uuid)"
        id="{{ selection.uuid }}"
        data-uuid="{{ selection.uuid }}"
        class="draggable-ts db-card-single-ts"
        ng-class="{'color-picker-is-open': colorPickersSettings[selection.timeseries], 'active': selection.active}">

        <div
          ng-if="metaData.type === 'timeseries'"
          id="{{ selection.timeseries }}"
          ng-click="toggleSelection(selection);"
          class="">

          <div
            class="db-card-color-picker-btn"
            ng-style="{'background-color': selection.color}"
            ng-click="toggleColorPicker(selection.timeseries); $event.stopPropagation();">
          </div>

          <div
            class="db-card-single-ts-name"
            title="{{ metaData.location }}, {{ metaData.uuid }}, {{ metaData.parameter }}"
            ng-init="displayName = (getTsDisplayName(selection) | truncate: 50)">
            {{ displayName }}
          </div>


          <color-picker
              ng-show="colorPickersSettings[selection.timeseries]"
              index="{{selection.timeseries}}" />

<!--           <color-picker /> -->
        </div>
      </div>
    </div>
  </div>

  <db-nested-asset asset="asset" time-state="timeState"></db-nested-asset>

</div>
